name: Automated API tests - Newman

on: push

env:
  COLLECTION_ID: 24574593-b537b40b-930a-4255-85b8-fe85e71026d8
  ENVIRONMENT_ID: 24574593-5c19695f-a80c-4e99-8efe-20b61147ce3f
  POSTMAN_API_KEY: ${{ secrets.POSTMAN_API_KEY }}

jobs:
  newman-collection-path:
    runs-on: ubuntu-latest
    steps:
      - name: Checks-out repository under $GITHUB_WORKSPACE
        uses: actions/checkout@master
      - name: Install Newman
        run: npm install -g newman
      - name: Run collection with Newman
        run: newman run ${{ github.workspace }}/postman/collections/Dinosaurs_API.json --environment https://api.postman.com/environments/${{ env.ENVIRONMENT_ID }}?apikey=${{ env.POSTMAN_API_KEY }}

  newman-collection-id:
    runs-on: ubuntu-latest
    steps:
      - name: Checks-out your repository under $GITHUB_WORKSPACE
        uses: actions/checkout@master
      - name: Install Newman
        run: npm install -g newman
      - name: Run collection with Newman
        run: newman run https://api.postman.com/collections/${{ env.COLLECTION_ID }}?apikey=${{ env.POSTMAN_API_KEY }} --environment https://api.postman.com/environments/${{ env.ENVIRONMENT_ID }}?apikey=${{ env.POSTMAN_API_KEY }}